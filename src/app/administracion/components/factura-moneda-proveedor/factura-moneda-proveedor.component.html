<div class="p-grid">
    <div class="p-col-12">
        <p-toast></p-toast>
        <div class="card">
            <div class="p-text-center">
                <h3>Facturas del proveedor/moneda</h3>
            </div>     
            <p-table #dt [value]="listaBalalceFacturaMoneda" responsiveLayout="scroll"  [rows]="10"
                [paginator]="true"
                [globalFilterFields]="['twFacturasProveedor.sFolioFactura','twFacturasProveedor.tcProveedore.sRfc','twFacturasProveedor.tcProveedore.sRazonSocial','twFacturasProveedor.dFechaInicioFactura','twFacturasProveedor.dFechaTerminoFactura','twFacturasProveedor.tcMoneda.sMoneda','twFacturasProveedor.nMontoFactura','venta.totalAbonos','venta.estatusFactura']"
                [rowHover]="true" dataKey="id" styleClass="p-datatable-customers"
                currentPageReportTemplate="Mostrar {first} al {last} de {totalRecords} ventas"
                [showCurrentPageReport]="true">
                <ng-template pTemplate="caption">
                    <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                        <span class="p-input-icon-left">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                                placeholder="Buscar Venta" />
                        </span>
                        <!--

                        <span class="p-input-icon-right">
                            <div _ngcontent-iho-c213="" class="p-col-12 p-mb-12 p-lg-12 p-mb-lg-0">
                                <button pButton pRipple type="button" label="Ventas por entregar" class="p-button-success" (click)="consultaVentas()"></button>
                            </div> 
                        </span>
                        -->

                       
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                    
                        <th pSortableColumn="twFacturasProveedor.sFolioFactura">Folio Factura<p-sortIcon field="twFacturasProveedor.sFolioFactura"></p-sortIcon>
                        </th>
                        <th pSortableColumn="twFacturasProveedor.tcProveedore.sRfc">RFC<p-sortIcon
                                field="twFacturasProveedor.tcProveedore.sRfc"></p-sortIcon>
                        </th>
                        <th pSortableColumn="twFacturasProveedor.tcProveedore.sRazonSocial">Razón social<p-sortIcon field="twFacturasProveedor.tcProveedore.sRazonSocial"></p-sortIcon>
                        </th>
                        <th pSortableColumn="twFacturasProveedor.dFechaInicioFactura">Fecha inicio factura<p-sortIcon field="twFacturasProveedor.dFechaInicioFactura"></p-sortIcon>
                        </th>
                        <th pSortableColumn="twFacturasProveedor.dFechaTerminoFactura">Fecha termino factura<p-sortIcon field="twFacturasProveedor.dFechaInicioFactura"></p-sortIcon>
                        </th>
                        <th pSortableColumn="twFacturasProveedor.tcMoneda.sMoneda">Moneda<p-sortIcon field="twFacturasProveedor.tcMoneda.sMoneda"></p-sortIcon>
                        </th>

                        <th pSortableColumn="twFacturasProveedor.nMontoFactura">Monto factura<p-sortIcon field="twFacturasProveedor.nMontoFactura"></p-sortIcon>
                        </th>
                        <th pSortableColumn="venta.totalAbonos">Total abonos<p-sortIcon
                                field="venta.totalAbonos"></p-sortIcon>

                        <th pSortableColumn="tcTipoVenta.sDescripcion">Saldo final
                                   
                        </th>
                        <th pSortableColumn="venta.estatusFactura">Estatus factura<p-sortIcon
                                field="venta.estatusFactura"></p-sortIcon>
                        </th>
                        <th></th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-venta let-expanded="expanded">
                    <tr>
                       
                        <td><span class="p-column-title">Rfc</span> {{venta.twFacturasProveedor.sFolioFactura}}
                        </td>
                        <td><span class="p-column-title">RFC</span> {{venta.twFacturasProveedor.tcProveedore.sRfc}}
                        </td>
                        <td><span class="p-column-title">Razón social</span>{{venta.twFacturasProveedor.tcProveedore.sRazonSocial}}
                        </td>
                        <td><span class="p-column-title">Fecha Inico Factura</span>{{venta.twFacturasProveedor.dFechaInicioFactura | date}}
                        </td>
                        <td><span class="p-column-title">Fecha Termino Factura</span>{{venta.twFacturasProveedor.dFechaTerminoFactura | date}}
                        </td>
                        <td><span class="p-column-title">Moneda</span>
                            <p-tag styleClass="p-mr-2" severity="success">{{venta.twFacturasProveedor.tcMoneda.sMoneda }}</p-tag>
                        </td>
                        <td><span class="p-column-title">Monto Factura</span>
                            <p-tag styleClass="p-mr-2" severity="success">{{venta.twFacturasProveedor.nMontoFactura | number}}</p-tag>
                        </td>
                        <td><span class="p-column-title">Total abonos</span>
                            <p-tag styleClass="p-mr-2" severity="success">{{venta.totalAbonos | number}}</p-tag>
                        </td>
                        <td><span class="p-column-title">Saldo Final</span>
                            <p-tag styleClass="p-mr-2" severity="success">{{(venta.twFacturasProveedor.nMontoFactura-venta.totalAbonos) | number}}</p-tag>
                        </td>
                        <td class="p-text-center"><span class="p-column-title">Estatus General</span>
							<div *ngIf="venta.estatusFactura=='PAGO VENCIDO'">
							<p-tag styleClass="p-mr-2" severity="danger">PAGO VENCIDO</p-tag>
						  </div>
						  <div *ngIf="venta.totalVeestatusFacturancidas=='POR PAGAR'">
							<p-tag styleClass="p-mr-2" severity="success">POR PAGAR</p-tag>
						  </div>
						</td>


                        <td>
                            <button pButton pRipple icon="pi pi-search" class="p-button-rounded p-button-success p-mr-2"
                                (click)="crearformulario(venta)"></button>
                           
                            
                        </td>
                    </tr>
                </ng-template>
            </p-table>
            <!--
            <p-toolbar styleClass="p-mb-4">
                <ng-template pTemplate="right">
                    <button type="button" pButton pRipple icon="pi pi-file-excel" label="Exportar consulta"
                        class="p-button-help p-mb-2" (click)="dt.exportCSV()"></button>
                </ng-template>
            </p-toolbar>
            -->

            <div class="p-grid p-jc-end">
                <div class="p-col-8">
                    <div class="box"></div>
                </div>
                <div class="p-col-2">
                    <div class="box">
                        <button pButton pRipple label="Cerrar" icon="pi pi-times" class="p-button-text" (click)="cerrarDetalle()"></button>
                    </div>
                </div>
               
            </div>


            <!--FORMULARIO DE REGISTRO DE ABONOS A FACTURAS DEL PROVEEDOR-->
            
        <p-dialog [(visible)]="banAbonoFacturaProveedor"  header="Abono factura del proveedor"
        [style]="{width: '60vw', height: '60vh'}"
        header="Facturas Activas" [modal]="true" styleClass="p-fluid" [closable]="true"  [autoZIndex]="true" [maximizable]="true">        
            <ng-template pTemplate="content">
               <div class="p-grid">
                <div class="p-col-4">
                    <p-panel header="Balance de la factura"  >
                        <div>Total Factura: $ {{totalFactura | number}} </div>

                        <div>Total abonos: $ {{totalAbonos | number}} </div>

                        <div><strong>Saldo final: $ {{saldoFinal | number}} </strong> </div>                     

                    </p-panel> 

                <form [formGroup]="formulario">        
                    <div class="p-field">
                        <label for="name">Abono</label>
                        <p-inputNumber id="nMonto" formControlName="nMonto" id="nMonto"
                        mode="currency" currency="USD" locale="en-US" [class.is-invalid]="nMonto"></p-inputNumber>

                        <small *ngIf="validasMonto" class="p-error">Monto no valido.</small>
                    </div>        
                </form>
                <button pButton pRipple label="Agregar Abono"  class="p-button-success" (click)="guardar()"></button>

               </div>
               <div class="p-col-6">
               hola

               </div>
            </div>
               
                    
            </ng-template>        
            <ng-template pTemplate="footer">
                <button pButton pRipple label="Cancelar" icon="pi pi-times" class="p-button-text"
                    (click)="hideDialog()"></button>
            </ng-template>
        
        
        </p-dialog>
        

 


        

        </div>


        <p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>
    </div>
</div>