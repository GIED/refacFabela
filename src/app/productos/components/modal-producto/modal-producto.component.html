<form [formGroup]="formulario" autocomplete="off">
  <input type="text" pInputText formControlName="nId" hidden />
  <input type="text" pInputText formControlName="nIdusuario" hidden />
  <input type="text" pInputText formControlName="nEstatus" hidden />
  <input type="text" pInputText formControlName="dFecha" hidden />

  <div class="p-grid">
    <!-- Primera fila -->
    <div class="p-field p-col-6">
      <label>No. de parte <span style="color:red">*</span></label>
      <input pInputText formControlName="sNoParte" (input)="teclaPresionada()" class="p-inputtext" />
              <p-listbox  styleClass="sugerencias-flotantes" *ngIf="mostrarSugerencias" [options]="listaNoParte" formControlName="sNoParte" optionLabel="sNoParte" (onClick)="valorSeleccionado()" optionValue="sNoParte" ></p-listbox>
      <small class="p-error" *ngIf="validaNoParte">*Número de Parte requerido.</small>
    </div>
    <div class="p-field p-col-6">
      <label>Nombre del producto <span style="color:red">*</span></label>
      <input pInputText formControlName="sProducto" class="p-inputtext" />
      <small class="p-error" *ngIf="validaProducto">*Nombre requerido.</small>
    </div>

    <!-- Segunda fila -->
    <div class="p-field p-col-12">
      <label>Descripción <span style="color:red">*</span></label>
      <textarea pInputTextarea formControlName="sDescripcion" rows="2"></textarea>
       <small class="p-error" *ngIf="validaDescripcion">*Descripción requerida.</small>
    </div>

    <!-- Tercera fila -->
    <div class="p-field p-col-6">
      <label>Código</label>
      <input pInputText formControlName="sIdBar" disabled />
    </div>
    <div class="p-field p-col-6">
      <label>Marca <span style="color:red">*</span></label>
      <input pInputText formControlName="sMarca" disabled />
    </div>

    <!-- Cuarta fila -->
    <div class="p-field p-col-6">
      <label>Marca catálogo <span style="color:red">*</span></label>
      <p-dropdown [options]="listaMarca" formControlName="nIdMarca" optionLabel="sMarca" optionValue="nId"   (onChange)="asignarMarca($event)" ></p-dropdown>
      <small class="p-error" *ngIf="validanIdMarca">*Marca requerida.</small>
    </div>
    <div class="p-field p-col-6">
      <label>Categoría general <span style="color:red">*</span></label>
      <p-dropdown [options]="listaCategoriaGeneral" formControlName="nIdCategoriaGeneral" optionLabel="sCategoriaGeneral" optionValue="nId" onchange="obtenerCategoria()"></p-dropdown>
      <small class="p-error" *ngIf="validaCategoriaGeneral">*Categoría general requerida.</small>
    </div>

    <!-- Quinta fila -->
    <div class="p-field p-col-6">
      <label>Categoría <span style="color:red">*</span></label>
      <p-dropdown [options]="listaCategoria" formControlName="nIdCategoria" optionLabel="sDescripcion" optionValue="nId"></p-dropdown>
      <small class="p-error" *ngIf="validaCategoria">*Categoría requerida.</small>
    </div>
    <div class="p-field p-col-6">
      <label>Precio <span style="color:red">*</span></label>
      <p-inputNumber formControlName="nPrecio" mode="currency" currency="USD" locale="en-US"></p-inputNumber>
      <small class="p-error" *ngIf="validaPrecio">*Precio requerido.</small>
    </div>
     <!-- Octava fila: medidas físicas -->
    <div class="p-field p-col-3">
      <label>Peso (kg)</label>
      <p-inputNumber formControlName="nPeso" [minFractionDigits]="2" [maxFractionDigits]="2"></p-inputNumber>
    </div>
    <div class="p-field p-col-3">
      <label>Largo (cm)</label>
      <p-inputNumber formControlName="nLargo" [minFractionDigits]="2" [maxFractionDigits]="2"></p-inputNumber>
    </div>
    <div class="p-field p-col-3">
      <label>Alto (cm)</label>
      <p-inputNumber formControlName="nAlto" [minFractionDigits]="2" [maxFractionDigits]="2"></p-inputNumber>
    </div>
    <div class="p-field p-col-3">
      <label>Ancho (cm)</label>
      <p-inputNumber formControlName="nAncho" [minFractionDigits]="2" [maxFractionDigits]="2" ></p-inputNumber>
    </div>

    <!-- Novena fila -->
        <div class="p-field p-col-6">
      <label>Volumen (cm³)</label>
      <p-inputNumber formControlName="nVolumen" [minFractionDigits]="2" [maxFractionDigits]="2" [disabled]="true"></p-inputNumber>
    </div>
    <div class="p-field p-col-6">
      <label>Ruta de imagen</label>
      <input pInputText formControlName="sRutaImagen" />
    </div>


    <!-- Sexta fila -->
    <div class="p-field p-col-6">
      <label>Moneda <span style="color:red">*</span></label>
      <p-dropdown [options]="listaMoneda" formControlName="sMoneda" optionLabel="name" optionValue="code"></p-dropdown>
      <small class="p-error" *ngIf="validaMoneda">*Moneda requerida.</small>
    </div>
    <div class="p-field p-col-6">
      <label>Ganancia <span style="color:red">*</span></label>
      <p-dropdown [options]="listaGanancia" formControlName="nIdGanancia" optionLabel="nGanancia" optionValue="nId" placeholder="Seleccione ganancia">
  <ng-template let-gan pTemplate="item">
    {{ gan.nGanancia | percent:'1.0-0' }}
  </ng-template>></p-dropdown>
      <small class="p-error" *ngIf="validaGanancia">*Ganancia requerida.</small>
    </div>

    <!-- Séptima fila -->
    <div class="p-field p-col-6">
      <label>Descuento <span style="color:red">*</span></label>
      <p-dropdown [options]="listaGanancia" formControlName="nIdDescuento" optionLabel="nId" optionValue="nId"></p-dropdown>
      <small class="p-error" *ngIf="validaDescuento">*Descuento requerido.</small>
    </div>
    <div class="p-field p-col-6">
      <label>Clave SAT <span style="color:red">*</span></label>
      <p-dropdown [options]="listaClaveSat" formControlName="nIdclavesat" optionLabel="sDescripcion" optionValue="nId"></p-dropdown>
      <small class="p-error" *ngIf="validaClaveSat">*Clave SAT requerida.</small>
    </div>

   
    <!-- Precio final -->
    <div class="p-field p-col-12 p-text-center">
      <label>Precio Final</label><br />
      <strong><p-tag><h2 style="color:white">{{precioFinal | currency}}</h2></p-tag></strong>
    </div>
  </div>
</form>

<div class="p-grid p-jc-end">
  <div class="p-col-2">
    <button pButton pRipple label="Cancelar" icon="pi pi-times" class="p-button-danger" (click)="cerrarModal()"></button>
  </div>
  <div class="p-col-2">
    <button pButton pRipple label="Guardar" icon="pi pi-check" class="p-button-success" (click)="saveProduct()" [disabled]="formulario.invalid"></button>
  </div>
</div>
